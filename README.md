## 基于 Radon 变换及其反投影逆过程的 CT 影像重建⽅案与单⽬标投影参数标定优化

2017 年全国大学生数学建模竞赛 A 题成果。与 @lyx988、@Lee-faner 合力完成。

### 摘要

CT (Computed Tomography) 可以在不破坏样品的情况下，利⽤样品对射线能量的吸收特性对⽣物组织和⼯程材料的样品进⾏断层成像，由此获取样品内部的结构信息。在该问题给定条件下，平⾏⼊射的 X  线垂直于探测器平⾯，整个发射-接收系统绕某固定的旋转中⼼逆时针旋转 180 次。对每⼀个 X 射线⽅向，在具有 512 个等距单元的探测器上测量经位置固定不动的⼆维待检测介质吸收衰减后的射线能量，并经过增益等处理后得到 180 组接收信息。

对于问题⼀，在 CT 系统标定参数未知的情况下，我们需要通过给定的投影数据来确定 CT 系统旋转中⼼在正⽅形托盘中的位置、探测器单元之间的距离以及该 CT 系统使⽤的 X 射线的 180 个⽅向。由 Lambert-Beer 定律对给定数据进⾏处理得到实际透射厚度，然后我们先利⽤⼩圆与射线的关系得到各探测单元间的距离，再采⽤解析⼏何⽅法，将弦长公式与平⾏线间距离公式联⽴求得 180 个⽅向分别对应的 X 射线的直线斜率，进⽽求出其⽅向，同时也得到了每个⽅向上各射线的具体⽅程，接着又采⽤三角形内切圆法及相对运动法求解转轴的坐标。

对于问题⼆、三，我们需要问题⼀中求得的的标定参数以及系统得到的某未知介质的接收信息来还原该断⾯未知介质在正⽅形托盘中的位置、⼏何形状和吸收率等信息，所以这是第⼀问求解的逆过程。我们知道 CT 系统的数据处理与 Radan 变换及逆变换密切相关，于是在这⾥我们采⽤ Radon 逆变换来对未知介质进⾏还原；另外，附件提供的是离散的投影数据点，⽽ Radon 逆变换本⾝的连续形式在该情况下不适⽤，所以这⾥我们将离散数据连续化处理之后，对探测器所在⾓度、探测器与旋转中⼼距离的离散数据进⾏插值，获得近似的连续投影函数，并进⾏⼆重积分数值求解，进⽽求得未知介质的相关信息，再在相同的模型下求得 10 个位置的透射率的信息。

对于问题四，我们通过两种⽅案对参数的精度和稳定性进⾏分析及改善。在问题⼆、三的求解中我们⽤到了⼆重积分数值求解的⽅法求解了未知介质的吸收率函数，再通过余项对间距、平均旋转⾓的标定参数求运⽤梯度下降优化法，来得到较优的标定参数；也可⽤遗传算法确定优质标定⽅案，为了简化计算量、获得直观效果，以⼀个在正⽅形托盘范围内的圆作为模板，控制探测器间距⼀定，半径、圆⼼坐标、扫描⾓度均为可变量，使⽤ MATLAB 提供的 Radon 变换⽅案进⾏适合度函数的计算与评估。

**关键词：** Radon 变换; 反投影重建算法; 多元⽬标函数优化

### 大体思路

-   问题一：根据已知条件求出探测器距离（必须）、观察特殊角度下某根射线的大概位置，由投影值与实际距离（mm）的正比关系，与椭圆方程联立，求出某条射线的 3 个方向，三条直线的内切圆圆心就是旋转中心。
-   问题二、三：逆 Radon 投影重建 + Ram-Lak 算法滤波，相关资料很多。
-   问题四：我们提出了基于最速梯度下降和遗传算法的两种优化方案，并重新设计模板结构，用遗传算法算出一组次优解。

### 项目结构

`/code` 里面是代码（MATLAB R2016a 和 Mathematica 11）。

`/article` 里面是 LaTeX 格式的论文。

`/resource` 里面是我们计算的 `problem2.xls` 和 `problem3.xls`，以及一些其他支撑数据。

`/figure` 里面是论文中的图像。

`/reference` 里面是参考文献（BibTeX）。